CALL paquExec('SELECT 2.0 + b.bdmId AS `_2__0_+_b__bdmId_`,b.snapnum AS `b.snapnum`,b.x AS `b.x`,b.y AS `b.y`,b.z AS `b.z`,b.phkey AS `b.phkey`,hilbertKey( 10, 1000.0, 3, `b`.`x`, `b`.`y`, `b`.`z` ) AS `xyzphkey`,b.Mvir AS `b.Mvir`,`xyzphkey` AS `xyzphkey` FROM MDPL.BDMW AS `b` WHERE ( `b`.`snapnum` = 88 ) AND ( `b`.`Mvir` > 1.e14 )   ', 'aggregation_tmp_94749708')
CALL paquExec('SELECT `b`.`b.snapnum` / `r`.`zred` AS `_b__snapnum_/_r__zred_`,r.zred AS `r.zred`,`b`.`_2__0_+_b__bdmId_` AS `_2__0_+_b__bdmId_`,`b`.`b.x` AS `b.x`,`b`.`b.y` AS `b.y`,`b`.`b.z` AS `b.z`,`b`.`b.phkey` AS `b.phkey`,`b`.`xyzphkey` AS `xyzphkey` FROM MDPL.Redshifts AS `r` JOIN ( SELECT `_2__0_+_b__bdmId_`,`b.snapnum`,`b.x`,`b.y`,`b.z`,`b.phkey`,`xyzphkey`,`b.Mvir`,`xyzphkey` FROM `aggregation_tmp_94749708`  ORDER BY `xyzphkey` ASC ) AS `b`  WHERE ( `b`.`b.snapnum` = `r`.`snapnum` )  ORDER BY `xyzphkey` ASC  LIMIT 0,10', 'aggregation_tmp_64325811')
CALL paquDropTmp('aggregation_tmp_94749708')
USE spider_tmp_shard; CREATE TABLE TEST.TEST ENGINE=MyISAM SELECT `_b__snapnum_/_r__zred_`,`r.zred`,`_2__0_+_b__bdmId_`,`b.x`,`b.y`,`b.z`,`b.phkey`,`xyzphkey` FROM `aggregation_tmp_64325811`  ORDER BY `xyzphkey` ASC  LIMIT 0,10
CALL paquDropTmp('aggregation_tmp_64325811')
